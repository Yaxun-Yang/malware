import pandas as pd
import time
import math
import numpy as np


def data_read():
    data = pd.read_csv("base_data/dwd_yunsec_aegis_file_vis_base_info.csv", usecols=[8])
    data = data.to_numpy()
    return data


def data_write(data):
    df = pd.DataFrame({"serious": data[0], "high": data[1], "lower": data[2]})
    df.to_csv("processed_data/level_feature.csv", mode='w', sep=',', index=False)


def main():
    data = data_read()
    new_data = np.empty([len(data), 3])
    for i in range(len(data)):
        if data[i][0] == 'lower':
            new_data[i] = [0, 0, 1]
        elif data[i][0] == 'high':
            new_data[i] = [0, 1, 0]
        else:
            new_data[i] = [1, 0, 0]

    data_write(new_data.transpose())


if __name__ == '__main__':
    main()
